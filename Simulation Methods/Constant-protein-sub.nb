(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    123115,       2819]
NotebookOptionsPosition[    121250,       2789]
NotebookOutlinePosition[    121676,       2806]
CellTagsIndexPosition[    121633,       2803]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"metabsetparameters", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numcells", ",", "hours", ",", "sampletime", ",", "sc", ",", "kydgamma",
        ",", "kypmax", ",", "kppmax", ",", "kpdgamma", ",", "secs", ",", 
       "timerez", ",", "numtime", ",", "yinit", ",", "pinit", ",", "li", ",", 
       "deltalmax", ",", "gmax", ",", "kdpmax", ",", "kbpmax", ",", "kbdmax", 
       ",", "hy", ",", "hp", ",", "ny", ",", "np", ",", "yield", ",", 
       "proteinsize", ",", "glucoseperaa", ",", "protyield", ",", "ks", ",", 
       "p", ",", "y", ",", "l", ",", "p2", ",", "y2", ",", "l2", ",", "do", 
       ",", "do2", ",", "b", ",", "exb", ",", "b2", ",", "doc", ",", "bc", 
       ",", "growthclock", ",", "gilltime", ",", "sumdelta", ",", "sumdelta2",
        ",", "sumdeltatrack", ",", "volume", ",", "volumetotal", ",", "kyp", 
       ",", "kpp", ",", "d", ",", "div", ",", "gi", ",", "cellcount", ",", 
       "titer", ",", "yc", ",", "pc"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"parameters", " ", "to", " ", "change"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numcells", " ", "=", "150"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "number", " ", "of", " ", "cells", " ", "to", " ", "simulate"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hours", "  ", "=", "6"}], ";", 
      RowBox[{"(*", 
       RowBox[{"hours", " ", "to", " ", "simulate"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sampletime", " ", "=", "600"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "how", " ", "often", " ", "to", " ", "sample", " ", "simulation"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sc", " ", "=", " ", "56000"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "initial", " ", "concentration", " ", "of", " ", "glucose", " ", 
        "uM"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"kydgamma", " ", "=", ".05"}], ";", 
      RowBox[{"(*", 
       RowBox[{"growth", " ", "factor", " ", "degradation", " ", "rate", " ", 
        RowBox[{"(", 
         RowBox[{"number", " ", "per", " ", "hour"}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"kypmax", " ", "=", "15"}], ";", 
      RowBox[{"(*", "5", "*)"}], 
      RowBox[{"(*", "20", "*)"}], 
      RowBox[{"(*", 
       RowBox[{"growth", " ", "factor", " ", "production", " ", "rate", " ", 
        RowBox[{"(", 
         RowBox[{"number", " ", "per", " ", "hour"}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"kppmax", " ", "=", "14"}], ";", 
      RowBox[{"(*", 
       RowBox[{"14", " ", "normal"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"protein", " ", "produciton", " ", "rate", " ", 
        RowBox[{"(", 
         RowBox[{"number", " ", "per", " ", "hour"}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"kpdgamma", " ", "=", ".0006"}], ";", 
      RowBox[{"(*", 
       RowBox[{"protein", " ", "degradation", " ", "rate", " ", 
        RowBox[{"(", 
         RowBox[{"number", " ", "per", " ", "hour"}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"kdpmax", "=", "20"}], ";", "\[IndentingNewLine]", 
      RowBox[{"kbpmax", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"kbdmax", "=", "0.00006"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"fixed", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"secs", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"timerez", " ", "=", 
       RowBox[{
        RowBox[{"1", "/", "3600"}], "*", "secs"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"time", " ", "step"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"numtime", "=", 
       RowBox[{"(", 
        RowBox[{"hours", "*", "3600"}], ")"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"how", " ", "many", " ", "time", " ", "steps"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"li", " ", "=", " ", "2.32"}], ";", 
      RowBox[{"(*", 
       RowBox[{"initial", " ", "cell", " ", "length", " ", "micron"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"deltalmax", " ", "=", "2.26"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "max", " ", "increase", " ", "in", " ", "cell", " ", "length", " ", 
        "before", " ", "division", " ", "micron"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gmax", " ", "=", " ", "2.1"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "maximum", " ", "average", " ", "steady", " ", "state", " ", "growth", 
        " ", "rate"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hy", "=", "16"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "half", " ", "max", " ", "value", " ", "for", " ", "growth", " ", 
        "factor"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"hp", "=", "200"}], ";"}], "*)"}], 
      RowBox[{"(*", "17", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hp", "=", "50"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ny", " ", "=", " ", "1"}], ";", 
      RowBox[{"(*", 
       RowBox[{"hill", " ", "coefficient", " ", "hill", " ", "function"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"np", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"np", "=", 
       RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yield", "=", 
       RowBox[{"8.144", "*", 
        RowBox[{"10", "^", "7"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "cell", " ", "volume", " ", "yield", " ", "per", " ", "substrate", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"um", "^", "3"}], " ", "per", " ", "1", "uM", " ", 
          "glucose"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"proteinsize", "=", "300"}], ";", 
      RowBox[{"(*", 
       RowBox[{"number", " ", "residues"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"glucoseperaa", "=", 
       RowBox[{"1.88193", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "18"}]}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"glucose", " ", "consumed", " ", "per", " ", "residue"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"protyield", " ", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"proteinsize", "*", "glucoseperaa"}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "protein", " ", "number", " ", "yield", " ", "per", " ", "substrate", 
        " ", "concentration", " ", 
        RowBox[{"(", 
         RowBox[{
         "number", " ", "per", " ", "1", " ", "uM", " ", "glucose"}]}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ks", "=", "500"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "half", " ", "maximum", " ", "growth", " ", "rate", " ", "glucose", 
        " ", "concentration", " ", 
        RowBox[{"(", 
         RowBox[{"5", "uM"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"initialize", " ", "protein"}], ",", " ", 
        RowBox[{"growth", " ", "factor"}], ",", " ", 
        RowBox[{"and", " ", "length", " ", "arrays"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"50", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kypmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"do", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kdpmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kbpmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"exb", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"do2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kdpmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kbpmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"li", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p2", " ", "=", 
       RowBox[{"Table", "[", " ", 
        RowBox[{"kppmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y2", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kypmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l2", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"li", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"initialize", " ", "growth", " ", "clock"}], ",", " ", 
        RowBox[{"gillespie", " ", "time", " ", "arrays"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"growthclock", " ", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gilltime", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"initialize", " ", "lk"}], ",", " ", 
        RowBox[{
        "the", " ", "sum", " ", "of", " ", "the", " ", "deltals", " ", 
         "after", " ", "division"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sumdelta", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sumdelta2", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sumdeltatrack", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"volume", "=", 
       RowBox[{"Pi", "*", 
        RowBox[{"(", 
         RowBox[{"1.26", "^", "2"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", 
           RowBox[{"1.26", "/", "3"}]}], ")"}], "/", "4"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"volume", " ", "in", " ", "micron", " ", "cubed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"volumetotal", "=", 
       RowBox[{"Total", "[", "volume", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kyp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kypmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kpp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"kppmax", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.5", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"div", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.5", ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yc", " ", "=", 
       RowBox[{"y", "/", "l"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pc", "=", 
       RowBox[{"p", "/", "l"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"doc", "=", 
       RowBox[{"do", "/", "l"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bc", "=", 
       RowBox[{"b", "/", "l"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gi", "=", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"gmax", "*", 
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"hy", "/", 
                 RowBox[{"yc", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "ny"}]}], 
             ")"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"sc", "/", 
            RowBox[{"(", 
             RowBox[{"ks", "+", "sc"}], ")"}]}], ")"}]}], ",", 
         RowBox[{"{", "numcells", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cellcount", "=", "numcells"}], ";", "\[IndentingNewLine]", 
      RowBox[{"titer", "=", 
       RowBox[{"Total", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "numcells", ",", "hours", ",", "sampletime", ",", "sc", ",", 
        "kydgamma", ",", "kypmax", ",", "kppmax", ",", "kpdgamma", ",", 
        "secs", ",", "timerez", ",", "numtime", ",", "yinit", ",", "pinit", 
        ",", "li", ",", "deltalmax", ",", "gmax", ",", "kdpmax", ",", 
        "kbpmax", ",", "kbdmax", ",", "hy", ",", "hp", ",", "ny", ",", "np", 
        ",", "yield", ",", "proteinsize", ",", "glucoseperaa", ",", 
        "protyield", ",", "ks", ",", "p", ",", "y", ",", "l", ",", "p2", ",", 
        "y2", ",", "l2", ",", "do", ",", "do2", ",", "b", ",", "exb", ",", 
        "b2", ",", "doc", ",", "bc", ",", "growthclock", ",", "gilltime", ",",
         "sumdelta", ",", "sumdelta2", ",", "sumdeltatrack", ",", "volume", 
        ",", "volumetotal", ",", "kyp", ",", "kpp", ",", "d", ",", "div", ",",
         "gi", ",", "cellcount", ",", "titer", ",", "yc", ",", "pc"}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.836322117796324*^9, 3.836322471697259*^9}, {
   3.83632260348007*^9, 3.836322609590934*^9}, {3.836322650126588*^9, 
   3.836322651175035*^9}, {3.836322696574788*^9, 3.836322813833671*^9}, {
   3.8363243182654576`*^9, 3.836324331408257*^9}, {3.836324533902106*^9, 
   3.8363245342763596`*^9}, {3.8363900241334734`*^9, 3.836390030743126*^9}, {
   3.836396853950185*^9, 3.836396889735905*^9}, 3.836409767355447*^9, {
   3.83641032021395*^9, 3.836410357280767*^9}, 3.836411199659828*^9, 
   3.836411590908888*^9, {3.836411708408738*^9, 3.836411709504863*^9}, 
   3.836411906399379*^9, 3.8364120223685727`*^9, {3.836412590001036*^9, 
   3.836412590987082*^9}, {3.836493303756198*^9, 3.836493304338679*^9}, {
   3.836572149516634*^9, 3.836572151388375*^9}, {3.836573738933395*^9, 
   3.836573739955887*^9}, {3.836653182420057*^9, 3.8366531914958878`*^9}, {
   3.836654355288605*^9, 3.836654355765875*^9}, {3.836660984328368*^9, 
   3.836660984734667*^9}, {3.8366655088043547`*^9, 3.836665511971177*^9}, {
   3.836665985643464*^9, 3.836665986247256*^9}, {3.836685986977624*^9, 
   3.8366859882563963`*^9}, {3.83668685454531*^9, 3.836686854833867*^9}, {
   3.8367422224764175`*^9, 3.8367422228726397`*^9}, {3.836748814208573*^9, 
   3.836748814459137*^9}, 3.836749362641682*^9, {3.836749577393607*^9, 
   3.836749584138674*^9}, {3.836828899408766*^9, 3.836828899659354*^9}, {
   3.8368292538475504`*^9, 3.836829255677493*^9}, {3.83684058602692*^9, 
   3.836840615973008*^9}, {3.836841831249573*^9, 3.836841832357502*^9}, {
   3.836846604980773*^9, 3.836846626838993*^9}, {3.836995456488607*^9, 
   3.836995502715989*^9}, {3.83699556767794*^9, 3.8369955754827757`*^9}, {
   3.83699606925443*^9, 3.836996094919833*^9}, 3.8369975228875284`*^9, 
   3.836997790890819*^9, {3.836999946660377*^9, 3.8369999467860317`*^9}, {
   3.837000256185897*^9, 3.837000256526852*^9}, 3.8370006155290627`*^9, {
   3.837000892867302*^9, 3.837000895114094*^9}, {3.837001874213015*^9, 
   3.8370019219470916`*^9}, {3.837002630972787*^9, 3.837002648210029*^9}, {
   3.837002788737187*^9, 3.837002789666108*^9}, {3.837079317331284*^9, 
   3.837079317955625*^9}, {3.8370906309228754`*^9, 3.837090631278889*^9}, {
   3.837253130481379*^9, 3.8372531310470734`*^9}, 3.837622471427309*^9, 
   3.837683567467162*^9, 3.837686885846403*^9, {3.837688031878699*^9, 
   3.837688041648558*^9}, {3.837700807972666*^9, 3.837700808666167*^9}, 
   3.837703703785363*^9, {3.83778309664074*^9, 3.837783097596359*^9}, {
   3.8377831510015645`*^9, 3.8377831522333755`*^9}, {3.8378546277775726`*^9, 
   3.837854628123986*^9}, {3.837858017124995*^9, 3.8378580176078796`*^9}, {
   3.837866584134935*^9, 3.837866617974084*^9}, {3.83786715178362*^9, 
   3.837867152621972*^9}, {3.837867247991044*^9, 3.837867256272434*^9}, 
   3.837870879907933*^9, {3.8381123701934323`*^9, 3.83811237292132*^9}, {
   3.8381130893239*^9, 3.838113105660364*^9}, {3.838126242672078*^9, 
   3.838126246427142*^9}, {3.838203762350961*^9, 3.838203762648308*^9}, 
   3.838207236891062*^9, {3.8382081738765635`*^9, 3.838208178037031*^9}, {
   3.838210695470078*^9, 3.838210696126105*^9}, {3.838287227339656*^9, 
   3.838287250013611*^9}, {3.838295767199588*^9, 3.838295767335331*^9}, {
   3.838733451426406*^9, 3.838733451925587*^9}, {3.838803761613868*^9, 
   3.838803762044397*^9}, {3.838805877023566*^9, 3.838805905260417*^9}, {
   3.838807845679519*^9, 3.838807849284636*^9}, {3.8388079964263287`*^9, 
   3.8388079977570944`*^9}, {3.838822947094061*^9, 3.838822947797145*^9}, {
   3.8388230008060203`*^9, 3.838823001152319*^9}, {3.838826279135361*^9, 
   3.838826290088497*^9}, {3.838910851157978*^9, 3.838910851567903*^9}, {
   3.8389882305654664`*^9, 3.838988235741095*^9}, {3.8390797367013807`*^9, 
   3.839079739515624*^9}, {3.8390815728071814`*^9, 3.839081572932124*^9}, 
   3.839081914686891*^9, {3.839082047102403*^9, 3.839082051610721*^9}, {
   3.839082221493479*^9, 3.839082229186254*^9}, 3.83908245193327*^9, 
   3.839082555378459*^9, 3.8390826826276007`*^9, {3.839082860583907*^9, 
   3.83908286066906*^9}, 3.8390832421202135`*^9, 3.839083512759884*^9, 
   3.839083633500107*^9, {3.8390837909620953`*^9, 3.83908380078866*^9}, 
   3.839083972671527*^9, 3.839084101924799*^9, 3.839086025970518*^9, 
   3.839086066141689*^9, {3.83914801575386*^9, 3.839148016228748*^9}, {
   3.839148064323413*^9, 3.8391480897310987`*^9}, {3.83915526668594*^9, 
   3.839155268064107*^9}, {3.839239541669712*^9, 3.839239548048206*^9}, {
   3.839243393647466*^9, 3.839243398498624*^9}, 3.839248828288786*^9, {
   3.8392610725606833`*^9, 3.8392610727471976`*^9}, {3.839265598703213*^9, 
   3.839265598776645*^9}, {3.8392657090741625`*^9, 3.83926570912848*^9}, {
   3.839272793966313*^9, 3.839272794077631*^9}, {3.839273431225124*^9, 
   3.839273455042208*^9}, 3.839275090149075*^9, 3.839276795717757*^9, 
   3.839278839820503*^9, 3.839410388599493*^9, {3.839410634240224*^9, 
   3.839410634559928*^9}, {3.8394111570968957`*^9, 3.8394111659972434`*^9}, {
   3.839411622686927*^9, 3.839411622746541*^9}, {3.839416212888955*^9, 
   3.8394162138838077`*^9}, {3.839418101901005*^9, 3.839418108209611*^9}, {
   3.839419988305407*^9, 3.839419988382838*^9}, {3.839424061149688*^9, 
   3.839424063200373*^9}, {3.839432489256799*^9, 3.8394324894107265`*^9}, 
   3.839515161307302*^9, {3.8395215877908287`*^9, 3.839521596218718*^9}, {
   3.839582101152644*^9, 3.839582101597308*^9}, 3.839584185559748*^9, 
   3.8395853078243403`*^9, {3.839585444236765*^9, 3.839585447119459*^9}, {
   3.839588116859303*^9, 3.839588118367805*^9}, {3.8395882454363604`*^9, 
   3.839588246845316*^9}, {3.8395883713150663`*^9, 3.839588384285814*^9}, 
   3.8395908924852843`*^9, 3.8395912508487215`*^9, 3.839591553605276*^9, 
   3.839593917437768*^9, 3.839599531296363*^9, 3.839602517157171*^9, {
   3.839603044324387*^9, 3.8396030566555324`*^9}, 3.839605875260772*^9, 
   3.839605943985589*^9, {3.839606263363823*^9, 3.8396062639012876`*^9}, {
   3.839607659355628*^9, 3.839607659708931*^9}, {3.8396089571249943`*^9, 
   3.839608962015905*^9}, {3.8396687411481733`*^9, 3.8396687420215464`*^9}, {
   3.839669060029832*^9, 3.8396690604052663`*^9}, {3.839678540543162*^9, 
   3.8396785424722633`*^9}, 3.839679556349287*^9, {3.839682385789011*^9, 
   3.839682388552416*^9}, 3.8397692044033766`*^9, 3.8398491935406194`*^9, {
   3.839849467233208*^9, 3.839849472187752*^9}, 3.839854064542704*^9, {
   3.840015926301749*^9, 3.840015929039387*^9}, 3.840016971173393*^9, {
   3.840108056552539*^9, 3.840108066298105*^9}, {3.840108158503381*^9, 
   3.840108161091902*^9}, {3.8401132470471954`*^9, 3.840113247093655*^9}, {
   3.84012093890564*^9, 3.840120944931607*^9}, {3.840130275302099*^9, 
   3.840130275489173*^9}, {3.840187963512165*^9, 3.8401879635746794`*^9}, {
   3.84019140219102*^9, 3.840191402347279*^9}, {3.840273944442743*^9, 
   3.8402739445204554`*^9}, {3.8402850012075605`*^9, 3.840285001410699*^9}, {
   3.840285249905888*^9, 3.840285249983878*^9}, {3.8403623722322545`*^9, 
   3.840362373231986*^9}, {3.8403717992382755`*^9, 3.840371799316408*^9}, {
   3.840446921822857*^9, 3.840446921884945*^9}, 3.840546255727321*^9, {
   3.8406189161943717`*^9, 3.840618918563696*^9}, {3.840618985513102*^9, 
   3.8406189889945135`*^9}, {3.840619209956644*^9, 3.840619210018731*^9}, 
   3.840635664629449*^9, {3.840642032203004*^9, 3.84064203568012*^9}, {
   3.840643744148081*^9, 3.840643779070453*^9}, {3.840709821802935*^9, 
   3.8407098372860785`*^9}, {3.8407194294052267`*^9, 3.840719438433769*^9}, {
   3.8408874082612348`*^9, 3.8408874097628365`*^9}, 3.8408879425682497`*^9, {
   3.8408883226460514`*^9, 3.84088836476086*^9}, {3.840888469907285*^9, 
   3.840888584553667*^9}, {3.840888744471957*^9, 3.840888764592317*^9}, {
   3.840888990785589*^9, 3.8408889912123947`*^9}, {3.840889269448962*^9, 
   3.8408892896787477`*^9}, {3.84088932309716*^9, 3.8408893431593266`*^9}, {
   3.840889913828557*^9, 3.8408899783490553`*^9}, {3.8408947545022416`*^9, 
   3.840894761648331*^9}, {3.84089499515055*^9, 3.840895023129784*^9}, {
   3.840895548611712*^9, 3.840895548840344*^9}, {3.8408957213376718`*^9, 
   3.840895727369519*^9}, {3.840977012755417*^9, 3.84097701446538*^9}, {
   3.8411480145502834`*^9, 3.841148018500689*^9}, {3.841318366544851*^9, 
   3.841318368976318*^9}, 3.841330274784015*^9, {3.841331968450742*^9, 
   3.84133197462426*^9}, {3.8413320482694216`*^9, 3.8413320497266693`*^9}, 
   3.841406731856121*^9, 3.841408275303252*^9, {3.841409822563183*^9, 
   3.841409822623432*^9}, {3.8414148920036325`*^9, 3.841414895005411*^9}, 
   3.841415065580558*^9, {3.841482934979111*^9, 3.8414829387499638`*^9}, {
   3.8414839188939037`*^9, 3.841483919396691*^9}, {3.841486516258055*^9, 
   3.841486516351222*^9}, 3.841487369991319*^9, 3.841503979808837*^9, {
   3.841569504640011*^9, 3.8415695047049866`*^9}, 3.841569824502656*^9, {
   3.8415738618541746`*^9, 3.841573861998014*^9}, {3.841574439236387*^9, 
   3.8415744394010735`*^9}, 3.8415931034653788`*^9, 3.841593787623437*^9, {
   3.841602364444555*^9, 3.841602364523578*^9}, {3.841756729058778*^9, 
   3.841756764875952*^9}, {3.8417659701718073`*^9, 3.8417659707051334`*^9}, {
   3.841832460053515*^9, 3.841832471069049*^9}, 3.842260332541955*^9, 
   3.842619567528743*^9, {3.842709415484129*^9, 3.842709415562257*^9}, {
   3.843224120344825*^9, 3.8432241207126017`*^9}, {3.843817711114663*^9, 
   3.843817711192791*^9}, 3.8438387017625012`*^9, {3.8439021816418924`*^9, 
   3.843902182595367*^9}, {3.883153869491324*^9, 3.8831538734114475`*^9}, {
   3.883153906175963*^9, 3.883153906223323*^9}, {3.883673599391697*^9, 
   3.8836736017247105`*^9}, {3.9192660327346554`*^9, 3.919266053196047*^9}, {
   3.9192689800674686`*^9, 3.9192689828836*^9}, {3.919269646784769*^9, 
   3.9192696473610535`*^9}, {3.919294522102375*^9, 3.9192945278517017`*^9}, {
   3.920032986491604*^9, 3.920032987990945*^9}, {3.924737495646121*^9, 
   3.9247374957987013`*^9}, 3.92473758802481*^9, {3.9439142806272087`*^9, 
   3.94391428075263*^9}, {3.943915492545273*^9, 3.943915492670683*^9}, {
   3.9439444493429756`*^9, 3.9439444494281387`*^9}, {3.943948859808626*^9, 
   3.9439488599340305`*^9}, {3.955498764548584*^9, 3.9554987675651054`*^9}, 
   3.9554988569294624`*^9, 3.955501684922537*^9, {3.955542640254019*^9, 
   3.9555426403337975`*^9}, {3.9555457592360973`*^9, 3.9555457593152122`*^9}, 
   3.956134398790573*^9, {3.9561345269788685`*^9, 3.9561345273719654`*^9}, 
   3.9561406060896225`*^9, 3.956141322974535*^9, {3.9562390608695755`*^9, 
   3.956239061134691*^9}, {3.956244949520443*^9, 3.9562449497724457`*^9}, {
   3.9562450124801865`*^9, 3.956245023557951*^9}, {3.95624650009017*^9, 
   3.956246509839773*^9}, 3.956355617173134*^9, 3.9563577906024933`*^9, 
   3.9563578527919006`*^9, {3.9564165506966248`*^9, 3.9564165603617687`*^9}, {
   3.9564176034745865`*^9, 3.9564176044451237`*^9}, {3.956418632395094*^9, 
   3.9564186344534187`*^9}, 3.956419456150463*^9},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[300]:=",ExpressionUUID->"63e0bd43-f880-41d7-ad63-12fc71369dd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"metabgillespieburst", "[", 
    RowBox[{
    "y_", ",", "p_", ",", "pc_", ",", "do_", ",", "doc_", ",", "b_", ",", 
     "exb_", ",", "kydgamma_", ",", "kpdgamma_", ",", "kbdmax_", ",", "kyp_", 
     ",", "kpp_", ",", "kdp_", ",", "kbpset_", ",", "gilltime_", ",", 
     "growthclock_", ",", "pgeo_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kyd", ",", "kpd", ",", "kbd", ",", "kbp", ",", "ratetotal", ",", 
       "probs", ",", "gilladd", ",", "nextgilltime", ",", "action", ",", "p1",
        ",", "y1", ",", "do1", ",", "b1", ",", "exb1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kyd", "=", 
       RowBox[{"kydgamma", "*", "y"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kpd", "=", 
       RowBox[{"kpdgamma", "*", "p"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kbp", "=", 
       RowBox[{"kbpset", "*", "doc", "*", "pc"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kbd", "=", 
       RowBox[{"kbdmax", "*", "b"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ratetotal", " ", "=", 
       RowBox[{"kyp", "+", "kyd", "+", "kdp", "+", "kbp", "+", "kbd"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"probs", " ", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "/", "ratetotal"}], " ", "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"kyp", ",", "kyd", ",", "kdp", ",", "kbp", ",", "kbd"}], 
           "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gilladd", "=", 
       RowBox[{"fastExponential", "[", "ratetotal", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nextgilltime", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "<=", "growthclock"}], ",", 
            RowBox[{"#1", "+", "#2"}], ",", 
            RowBox[{"#1", "+", "0"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"gilltime", ",", "gilladd"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"action", " ", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomChoice", "[", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
           "]"}], "&"}], ",", "probs"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p1", "=", "p"}], ";", "\[IndentingNewLine]", 
      RowBox[{"y1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", ">", "#2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{"#3", ",", "\[IndentingNewLine]", "1", ",", 
              RowBox[{"#4", "+", 
               RowBox[{"RandomVariate", "[", 
                RowBox[{"GeometricDistribution", "[", ".5", "]"}], "]"}]}], 
              ",", "\[IndentingNewLine]", "2", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#4", "\[LessEqual]", "0"}], "||", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#4", "-", "1"}], ")"}], "\[LessEqual]", "0"}]}], 
                ",", "0", ",", 
                RowBox[{"#4", "-", "1"}]}], "]"}], ",", "\[IndentingNewLine]",
               "3", ",", "#4", ",", "\[IndentingNewLine]", "4", ",", "#4", 
              ",", "\[IndentingNewLine]", "5", ",", "#4"}], 
             "\[IndentingNewLine]", "]"}], ",", "#4"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"nextgilltime", ",", "gilltime", ",", "action", ",", "y"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"do1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", ">", "#2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "#3", ",", "\[IndentingNewLine]", "1", ",", "#4", ",", 
              "\[IndentingNewLine]", "2", ",", "#4", ",", 
              "\[IndentingNewLine]", "3", ",", 
              RowBox[{"#4", "+", "1"}], ",", "\[IndentingNewLine]", "4", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#4", "\[LessEqual]", "0"}], "||", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#4", "-", "1"}], ")"}], "\[LessEqual]", "0"}]}], 
                ",", "0", ",", 
                RowBox[{"#4", "-", "1"}]}], "]"}], ",", "\[IndentingNewLine]",
               "5", ",", "#4"}], "\[IndentingNewLine]", "]"}], ",", "#4"}], 
           "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"nextgilltime", ",", "gilltime", ",", "action", ",", "do"}],
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", ">", "#2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "#3", ",", "\[IndentingNewLine]", "1", ",", "#4", ",", 
              "\[IndentingNewLine]", "2", ",", "#4", ",", 
              "\[IndentingNewLine]", "3", ",", "#4", ",", 
              "\[IndentingNewLine]", "4", ",", 
              RowBox[{"#4", "+", "1"}], ",", "\[IndentingNewLine]", "5", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#4", "\[LessEqual]", "0"}], "||", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#4", "-", "1"}], ")"}], "\[LessEqual]", "0"}]}], 
                ",", "0", ",", 
                RowBox[{"#4", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
             "]"}], ",", "#4"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"nextgilltime", ",", "gilltime", ",", "action", ",", "b"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exb1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", ">", "#2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "#3", ",", "\[IndentingNewLine]", "1", ",", "#4", ",", 
              "\[IndentingNewLine]", "2", ",", "#4", ",", 
              "\[IndentingNewLine]", "3", ",", "#4", ",", 
              "\[IndentingNewLine]", "4", ",", "#4", ",", 
              "\[IndentingNewLine]", "5", ",", 
              RowBox[{"#4", "+", "1"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "#4"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "nextgilltime", ",", "gilltime", ",", "action", ",", "exb"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "p1", ",", "y1", ",", "do1", ",", "b1", ",", "exb1", ",", 
        "nextgilltime"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.836402170776821*^9, 3.836402172488198*^9}, {
   3.8364026922735496`*^9, 3.8364027087676134`*^9}, {3.836404566397955*^9, 
   3.836404577211316*^9}, 3.8364046501017113`*^9, {3.836404690756514*^9, 
   3.836404691420643*^9}, {3.8364111565083513`*^9, 3.836411158142172*^9}, {
   3.836411545961363*^9, 3.836411546882932*^9}, {3.836412051802715*^9, 
   3.83641205189001*^9}, 3.8364129020367026`*^9, 3.836414093765684*^9, {
   3.8367407502943244`*^9, 3.836740765242793*^9}, {3.8390800898087816`*^9, 
   3.8390801055034547`*^9}, 3.839081908021425*^9, 3.83908219296856*^9, 
   3.83908285446036*^9, {3.839083963296791*^9, 3.8390839634529037`*^9}, {
   3.839086042789504*^9, 3.83908604326018*^9}, 3.8392395313643165`*^9, 
   3.83924340397342*^9, 3.839248836668978*^9, 3.8392656052419577`*^9, 
   3.839273442157626*^9, {3.839276809713523*^9, 3.839276809779436*^9}, 
   3.8394103968239574`*^9, {3.839496239861345*^9, 3.83949624014587*^9}, {
   3.839500798073682*^9, 3.839500798227014*^9}, {3.839506443132346*^9, 
   3.839506443948577*^9}, {3.8395106369158163`*^9, 3.8395106369733105`*^9}, {
   3.8395133264437737`*^9, 3.839513326661282*^9}, 3.839515096276879*^9, {
   3.839515762359027*^9, 3.8395157624308186`*^9}, {3.8395176261677227`*^9, 
   3.839517629831633*^9}, {3.839520766478344*^9, 3.839520769397264*^9}, {
   3.839521183022288*^9, 3.839521183861733*^9}, {3.839521786781348*^9, 
   3.8395218065106416`*^9}, {3.839588271888266*^9, 3.839588324868818*^9}, {
   3.839849413073487*^9, 3.8398494320732956`*^9}, {3.840645114593486*^9, 
   3.840645117127554*^9}, {3.840713730400534*^9, 3.840713761451092*^9}, {
   3.8407159260294333`*^9, 3.8407159298246937`*^9}, {3.840892737474918*^9, 
   3.8408928886389494`*^9}, {3.840892929916537*^9, 3.8408929809486227`*^9}, {
   3.840893035932781*^9, 3.840893168950877*^9}, {3.840893342875386*^9, 
   3.840893430597474*^9}, 3.840893494032856*^9, {3.8408954129248533`*^9, 
   3.840895441779527*^9}, {3.8417568027508726`*^9, 3.841756843634289*^9}, {
   3.841756946533765*^9, 3.8417569487476454`*^9}, {3.955499030339878*^9, 
   3.9554990441024494`*^9}, {3.956142751621443*^9, 3.9561427884755955`*^9}, {
   3.956143004530388*^9, 3.9561430358408546`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[301]:=",ExpressionUUID->"7c0bfd69-2628-45d1-9fe7-ac41f613d277"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fastExponential", "[", "param_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"Dimensions", "[", "param", "]"}]}], "]"}], "]"}]}], "/", 
      "param"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.840715189702787*^9, 3.840715256778594*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[302]:=",ExpressionUUID->"6ca669e4-40d9-472f-a784-aedd295fb7a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"updateconcgr", "[", 
     RowBox[{
     "pc_", ",", "y_", ",", "l_", ",", "gi_", ",", "hy_", ",", "hp_", ",", 
      "ny_", ",", "np_", ",", "gmax_", ",", "sc_", ",", "ks_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pc1", ",", "yc1", ",", "gi1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pc1", "=", "pc"}], ";", "\[IndentingNewLine]", 
       RowBox[{"yc1", "=", 
        RowBox[{"y", "/", "l"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gi1", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "0"}], ",", "\[IndentingNewLine]", 
             "0", ",", 
             RowBox[{"(*", 
              RowBox[{
              "if", " ", "yc", " ", "less", " ", "than", " ", "0", " ", "set",
                " ", "gi", " ", "to", " ", "0", " ", "to", " ", "prevent", 
               " ", 
               RowBox[{"1", "/", "0"}], " ", "error"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"gmax", "*", 
              RowBox[{"(", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"hy", "/", "#"}], ")"}], "^", "ny"}]}], ")"}]}], 
               ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"sc", "/", 
                RowBox[{"(", 
                 RowBox[{"ks", "+", "sc"}], ")"}]}], ")"}]}]}], 
            RowBox[{"(*", 
             RowBox[{"*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "f"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"hp", "/", "pc"}], ")"}], "^", "np"}]}], ")"}]}], 
                "+", "f"}], ")"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
           "&"}], ",", "yc1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "gi1"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8363878817063036`*^9, 3.836388014488752*^9}, 
   3.836995323262352*^9, {3.8369953926365433`*^9, 3.836995406642908*^9}, {
   3.836998002088406*^9, 3.836998009133831*^9}, {3.83699804935871*^9, 
   3.8369980569522543`*^9}, {3.8371795180250845`*^9, 3.837179533160345*^9}, {
   3.837255570145699*^9, 3.837255584699586*^9}, {3.8372612985498066`*^9, 
   3.8372613063451977`*^9}, {3.840892557288546*^9, 3.840892575589458*^9}, {
   3.840893177340734*^9, 3.84089318414103*^9}, {3.8408965058791866`*^9, 
   3.8408965066740003`*^9}, {3.841764148603509*^9, 3.841764152308117*^9}, {
   3.881800598273949*^9, 3.881800623553829*^9}, {3.881800743987332*^9, 
   3.881800744974224*^9}, {3.881827236602873*^9, 3.881827237205571*^9}, {
   3.881830387335842*^9, 3.8818304005603237`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[303]:=",ExpressionUUID->"8fe2ac90-5a66-45a7-a144-14e096e103cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateconcgrposfdbk", "[", 
    RowBox[{
    "pc_", ",", "y_", ",", "l_", ",", "gi_", ",", "hy_", ",", "hp_", ",", 
     "ny_", ",", "np_", ",", "gmax_", ",", "sc_", ",", "ks_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pc1", ",", "yc1", ",", "gi1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pc1", "=", "pc"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yc1", "=", 
       RowBox[{"y", "/", "l"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gi1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "<=", "0"}], "||", 
             RowBox[{"#2", "\[LessEqual]", "0"}]}], ",", 
            "\[IndentingNewLine]", "0", ",", 
            RowBox[{"(*", 
             RowBox[{
             "if", " ", "yc", " ", "less", " ", "than", " ", "0", " ", "set", 
              " ", "gi", " ", "to", " ", "0", " ", "to", " ", "prevent", " ", 
              RowBox[{"1", "/", "0"}], " ", "error"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"gmax", "*", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"hy", "/", "#1"}], ")"}], "^", "ny"}]}], ")"}]}], 
              ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"sc", "/", 
               RowBox[{"(", 
                RowBox[{"ks", "+", "sc"}], ")"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"hp", "/", "#2"}], ")"}], "^", "np"}]}], ")"}]}], 
              ")"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"yc1", ",", "pc1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "gi1"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8369961441576953`*^9, 3.8369961526774035`*^9}, {
   3.836996195630803*^9, 3.836996197409063*^9}, {3.836997341239379*^9, 
   3.836997414120148*^9}, {3.836997844766419*^9, 3.8369978610167637`*^9}, {
   3.836997961549788*^9, 3.8369979766347933`*^9}, {3.836998862467558*^9, 
   3.8369988635106173`*^9}, {3.8371794967056847`*^9, 
   3.8371795054424686`*^9}, {3.837255554985887*^9, 3.8372555615744677`*^9}, {
   3.837261309431313*^9, 3.837261315649066*^9}, {3.841764131868651*^9, 
   3.841764135616127*^9}, 3.881800634455438*^9, {3.881800753087302*^9, 
   3.881800754135582*^9}, {3.881827240844761*^9, 3.881827246657561*^9}, {
   3.88183037680364*^9, 3.881830380247679*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[304]:=",ExpressionUUID->"ec4139cf-9558-4f2e-bc2a-61d9f14f5cdc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateconcgrmxfdbk", "[", 
    RowBox[{
    "bc_", ",", "y_", ",", "l_", ",", "gi_", ",", "hy_", ",", "hmx_", ",", 
     "ny_", ",", "nmx_", ",", "gmax_", ",", "sc_", ",", "ks_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pc1", ",", "yc1", ",", "gi1", ",", "bc1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bc1", "=", "bc"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yc1", "=", 
       RowBox[{"y", "/", "l"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gi1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "<=", "0"}], "||", 
             RowBox[{"#2", "\[LessEqual]", "0"}]}], ",", 
            "\[IndentingNewLine]", "0", ",", 
            RowBox[{"(*", 
             RowBox[{
             "if", " ", "yc", " ", "less", " ", "than", " ", "0", " ", "set", 
              " ", "gi", " ", "to", " ", "0", " ", "to", " ", "prevent", " ", 
              RowBox[{"1", "/", "0"}], " ", "error"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"gmax", "*", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"hy", "/", "#1"}], ")"}], "^", "ny"}]}], ")"}]}], 
              ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"sc", "/", 
               RowBox[{"(", 
                RowBox[{"ks", "+", "sc"}], ")"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"hmx", "/", "#2"}], ")"}], "^", "nmx"}]}], ")"}]}],
               ")"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"yc1", ",", "bc1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "gi1"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.841763999260929*^9, 3.8417640844106293`*^9}, {
  3.841764117650642*^9, 3.8417641229030247`*^9}, {3.841764247659875*^9, 
  3.841764250462684*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"aea8572e-8448-4453-bc24-614b0e7147b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updatevolumetitersub", "[", 
    RowBox[{
    "l_", ",", "deltal_", ",", "volumetotal_", ",", "numcells_", ",", 
     "cellcount_", ",", "titer_", ",", "mxtiter_", ",", "p_", ",", 
     "currentp_", ",", "exb_", ",", "scup_", ",", "yield_", ",", "protyield_",
      ",", "do_", ",", "doup_", ",", "currentdo_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oldvolume", ",", "newvolume", ",", "volumetotal1", ",", "titer1", ",", 
       "mxtiter1", ",", "sc1", ",", "biomassyield", ",", "proteinyield", ",", 
       "metaboliteyield", ",", "do1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"oldvolume", "=", 
       RowBox[{"Pi", "*", 
        RowBox[{"(", 
         RowBox[{"1.26", "^", "2"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", 
           RowBox[{"1.26", "/", "3"}]}], ")"}], "/", "4"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newvolume", "=", 
       RowBox[{"Pi", "*", 
        RowBox[{"(", 
         RowBox[{"1.26", "^", "2"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "+", "deltal"}], ")"}], "-", 
           RowBox[{"1.26", "/", "3"}]}], ")"}], "/", "4"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"volumetotal1", "=", 
       RowBox[{"volumetotal", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"(", 
             RowBox[{"newvolume", "-", "oldvolume"}], ")"}], "]"}], "/", 
           "numcells"}], ")"}], "*", "cellcount"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "keep", " ", "track", " ", "of", " ", "the", " ", "total", " ", "cell",
         " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"titer1", "=", 
       RowBox[{"titer", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"(", 
             RowBox[{"p", "-", "currentp"}], ")"}], "]"}], "/", "numcells"}], 
          ")"}], "*", "cellcount"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "keep", " ", "track", " ", "of", " ", "the", " ", "total", " ", 
        "number", " ", "of", " ", "protein"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mxtiter1", "=", 
       RowBox[{"mxtiter", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", "exb", "]"}], "/", "numcells"}], ")"}], "*", 
         "cellcount"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"(", 
           RowBox[{"newvolume", "-", "oldvolume"}], ")"}], "]"}], ">", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"sc1", "=", 
         RowBox[{"scup", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "yield"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"(", 
               RowBox[{"newvolume", "-", "oldvolume"}], ")"}], "]"}], "/", 
             "numcells"}], ")"}], "*", "cellcount"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"(", 
           RowBox[{"do", "-", "currentdo"}], ")"}], "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"do1", "=", 
         RowBox[{"doup", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"10", "^", "23"}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"(", 
               RowBox[{"do", "-", "currentdo"}], ")"}], "]"}], "/", 
             "numcells"}], ")"}], "*", "cellcount"}]}]}], ",", 
        RowBox[{"do1", "=", 
         RowBox[{"doup", "+", "0"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "remove", " ", "substrate", " ", "according", " ", "to", " ", 
         "yield"}], ",", " ", 
        RowBox[{"volume", " ", "change"}], ",", " ", 
        RowBox[{"and", " ", "number", " ", "of", " ", "cells"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"(", 
             RowBox[{"p", "-", "currentp"}], ")"}], "]"}], ">", "0"}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "check", " ", "if", " ", "current", " ", "protein", " ", "amount",
              " ", "is", " ", "larger", " ", "than", " ", "previous", " ", 
             "time"}], ",", " ", 
            RowBox[{
            "this", " ", "prevents", " ", "substrate", " ", "addition", " ", 
             "when", " ", "mean", " ", "p", " ", "decreases", " ", "from", 
             " ", "previous", " ", "point"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sc1", "=", 
           RowBox[{"scup", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "protyield"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"(", 
                 RowBox[{"p", "-", "currentp"}], ")"}], "]"}], "/", 
               "numcells"}], ")"}], "*", "cellcount"}]}]}]}], "]"}], ";"}], 
       "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "remove", " ", "substrate", " ", "according", " ", "to", " ", 
         "protein", " ", "yield"}], ",", " ", 
        RowBox[{
        "and", " ", "change", " ", "in", " ", "total", " ", "number", " ", 
         "of", " ", "protein"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"scup", "<", 
           RowBox[{"1", "*", 
            RowBox[{"10", "^", 
             RowBox[{"-", "11"}]}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sc1", "=", "0"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"proteinyield", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sc1", "-", "scup"}], ")"}], ">", "0"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"titer1", "-", "titer"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"sc1", "-", "scup"}], ")"}]}], ")"}], ",", "0"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"metaboliteyield", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sc1", "-", "scup"}], ")"}], ">", "0"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"mxtiter1", "-", "mxtiter"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"sc1", "-", "scup"}], ")"}]}], ")"}], ",", "0"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "volumetotal1", ",", "titer1", ",", "sc1", ",", "proteinyield", ",", 
        "mxtiter1", ",", "metaboliteyield", ",", "do1"}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.836388191511842*^9, 3.836388458925209*^9}, {
   3.836472891117897*^9, 3.836472933924509*^9}, {3.836487982213749*^9, 
   3.83648824924818*^9}, {3.836488295599854*^9, 3.836488335682208*^9}, {
   3.836488425769408*^9, 3.836488453989191*^9}, {3.8364892891492605`*^9, 
   3.836489330261998*^9}, {3.836489360416995*^9, 3.8364893989183784`*^9}, {
   3.836489664634555*^9, 3.836489710923734*^9}, {3.836490106628347*^9, 
   3.836490109202968*^9}, {3.836490148474503*^9, 3.8364902066040344`*^9}, {
   3.836490275286053*^9, 3.836490300083856*^9}, {3.836490476875259*^9, 
   3.8364904808455777`*^9}, {3.836491199061451*^9, 3.8364912045084*^9}, {
   3.8364913080296607`*^9, 3.83649133162289*^9}, {3.836491413186943*^9, 
   3.8364915231803923`*^9}, {3.8364915569091663`*^9, 3.836491617228341*^9}, {
   3.8364916601205587`*^9, 3.8364916750170918`*^9}, {3.836491971964861*^9, 
   3.836491993405919*^9}, {3.8364920913482075`*^9, 3.8364920967404337`*^9}, {
   3.836563993545836*^9, 3.8365640088284826`*^9}, {3.836565746351753*^9, 
   3.836565763619001*^9}, {3.8365659318281384`*^9, 3.836565941174694*^9}, {
   3.8365662904257307`*^9, 3.836566294896691*^9}, {3.836566398850398*^9, 
   3.836566401381678*^9}, 3.836566769609202*^9, 3.836566806714394*^9, {
   3.836578765737747*^9, 3.836578793191204*^9}, {3.836581781609478*^9, 
   3.836581787731384*^9}, {3.836649348040143*^9, 3.8366493518982005`*^9}, {
   3.8366606722064967`*^9, 3.836660675216217*^9}, 3.836660724798992*^9, {
   3.836660802291054*^9, 3.836660864789642*^9}, {3.8366609469034324`*^9, 
   3.836660949751488*^9}, {3.836661166060514*^9, 3.8366612019501934`*^9}, {
   3.836686896949726*^9, 3.836686937539604*^9}, {3.836742675365078*^9, 
   3.836742706980425*^9}, {3.836742793909753*^9, 3.836742796403542*^9}, {
   3.836747955347951*^9, 3.836747957892011*^9}, {3.83676141360539*^9, 
   3.8367614194328127`*^9}, {3.836766459202481*^9, 3.836766497485127*^9}, {
   3.836766532437399*^9, 3.83676653822602*^9}, {3.836833135612971*^9, 
   3.836833138441989*^9}, {3.836834433947886*^9, 3.836834437406867*^9}, {
   3.836855314681874*^9, 3.836855317901972*^9}, {3.8368589389986234`*^9, 
   3.836858941647842*^9}, {3.837618280471683*^9, 3.83761828808902*^9}, {
   3.841757310802641*^9, 3.841757313338231*^9}, {3.841757376907698*^9, 
   3.841757378950261*^9}, {3.8417575252598934`*^9, 3.8417576272030363`*^9}, {
   3.841758057792365*^9, 3.841758164968754*^9}, 3.8417585180296364`*^9, {
   3.841758552285962*^9, 3.841758554736235*^9}, {3.841758656317164*^9, 
   3.841758656790421*^9}, {3.842618944842202*^9, 3.842618945029714*^9}, {
   3.8426190053900924`*^9, 3.842619088241948*^9}, {3.842619178809835*^9, 
   3.8426191810186*^9}, 3.842619215301235*^9, {3.842619299254503*^9, 
   3.8426193000455365`*^9}, {3.842619420578741*^9, 3.8426194235827327`*^9}, {
   3.8426294400345163`*^9, 3.842629456922994*^9}, {3.842629618603055*^9, 
   3.842629645898707*^9}, {3.842629681127924*^9, 3.842629682018608*^9}, {
   3.842629740689207*^9, 3.842629758839677*^9}, {3.8426298366974936`*^9, 
   3.842629855237664*^9}, {3.8426300354820533`*^9, 3.8426300392744827`*^9}, {
   3.8426303599258766`*^9, 3.842630361722454*^9}, {3.842630650742719*^9, 
   3.8426306625657287`*^9}, {3.842630708816711*^9, 3.842630758516556*^9}, {
   3.842630800893966*^9, 3.842630802966154*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[306]:=",ExpressionUUID->"cb21325c-760d-4c0f-b9c9-14b868f12df5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"metabcelldivision", "[", 
     RowBox[{
     "d_", ",", "l_", ",", "p_", ",", "y_", ",", "do_", ",", "b_", ",", 
      "sumdelta_", ",", "deltalmax_", ",", "deltal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pdeg", ",", "ydeg", ",", "divl", ",", "divp", ",", "divy", ",", 
        "divdo", ",", "divb", ",", "d1", ",", "d2", ",", "l1", ",", "l2", ",",
         "p1", ",", "p2", ",", "y1", ",", "y2", ",", "do1", ",", "do2", ",", 
        "b1", ",", "b2", ",", "sumdelta1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pdeg", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ydeg", "=", "1"}], ";", 
       RowBox[{"(*", 
        RowBox[{"was", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"d1", "=", 
        RowBox[{"RandomSample", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2", "=", 
        RowBox[{"1", "-", "d1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"divl", "=", "l"}], ";", "\[IndentingNewLine]", 
       RowBox[{"divp", "=", "p"}], ";", "\[IndentingNewLine]", 
       RowBox[{"divy", "=", "y"}], ";", "\[IndentingNewLine]", 
       RowBox[{"divdo", "=", "do"}], ";", "\[IndentingNewLine]", 
       RowBox[{"divb", "=", "b"}], ";", "\[IndentingNewLine]", 
       RowBox[{"l1", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             RowBox[{"#2", " ", "+", "#3"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#2", " ", "+", "#3"}], ")"}], "*", "#4"}]}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "l", ",", "deltal", ",", "d1"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l2", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             RowBox[{"#2", " ", "+", "#3"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#2", " ", "+", "#3"}], ")"}], "*", "#4"}]}], "]"}], 
           "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "divl", ",", "deltal", ",", "d2"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "p", ",", "d1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "divp", ",", "d2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"y1", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", 
             RowBox[{"ydeg", "*", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NegativeBinomialDistribution", "[", 
                RowBox[{
                 RowBox[{"#2", " ", "*", 
                  RowBox[{"#3", "/", "ydeg"}]}], ",", "#3"}], "]"}], 
               "]"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "y", ",", "d1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"y2", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", 
             RowBox[{"ydeg", "*", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NegativeBinomialDistribution", "[", 
                RowBox[{
                 RowBox[{"#2", " ", "*", 
                  RowBox[{"#3", "/", "ydeg"}]}], ",", "#3"}], "]"}], 
               "]"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "divy", ",", "d2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"do1", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", 
             RowBox[{"ydeg", "*", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NegativeBinomialDistribution", "[", 
                RowBox[{
                 RowBox[{"#2", " ", "*", 
                  RowBox[{"#3", "/", "ydeg"}]}], ",", "#3"}], "]"}], 
               "]"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "do", ",", "d1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"do2", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", 
             RowBox[{"ydeg", "*", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NegativeBinomialDistribution", "[", 
                RowBox[{
                 RowBox[{"#2", " ", "*", 
                  RowBox[{"#3", "/", "ydeg"}]}], ",", "#3"}], "]"}], 
               "]"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "divdo", ",", "d2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"b1", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", 
             RowBox[{"ydeg", "*", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NegativeBinomialDistribution", "[", 
                RowBox[{
                 RowBox[{"#2", " ", "*", 
                  RowBox[{"#3", "/", "ydeg"}]}], ",", "#3"}], "]"}], 
               "]"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "b", ",", "d1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b2", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#2", " ", ",", "\[IndentingNewLine]", 
             RowBox[{"ydeg", "*", 
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NegativeBinomialDistribution", "[", 
                RowBox[{
                 RowBox[{"#2", " ", "*", 
                  RowBox[{"#3", "/", "ydeg"}]}], ",", "#3"}], "]"}], 
               "]"}]}]}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta", ",", "divb", ",", "d2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"sumdelta1", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "<=", "deltalmax"}], ",", "\[IndentingNewLine]", 
             "#", ",", "\[IndentingNewLine]", "0"}], "]"}], "&"}], ",", 
          "sumdelta"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "l1", ",", "l2", ",", "p1", ",", "p2", ",", "y1", ",", "y2", ",", 
         "do1", ",", "do2", ",", "b1", ",", "b2", ",", "sumdelta1"}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8363192315454884`*^9, 3.8363192404910994`*^9}, {
   3.8363192765605*^9, 3.836319307074348*^9}, 3.8363196340864325`*^9, {
   3.836319672745431*^9, 3.836319677707907*^9}, {3.83631992014974*^9, 
   3.836319941201314*^9}, {3.836320031059629*^9, 3.836320086445441*^9}, {
   3.8363201458605113`*^9, 3.836320148830248*^9}, {3.836320183496883*^9, 
   3.8363202834504185`*^9}, {3.8363203209750524`*^9, 3.83632034557557*^9}, {
   3.836320512256233*^9, 3.8363205143855934`*^9}, {3.836320577962869*^9, 
   3.8363208419701986`*^9}, {3.8363209451741357`*^9, 3.836320964973005*^9}, {
   3.836321056409673*^9, 3.83632121979462*^9}, {3.836389150019364*^9, 
   3.836389151415781*^9}, {3.836390168717276*^9, 3.836390170046923*^9}, 
   3.836397831940422*^9, 3.83639810838824*^9, {3.8364047020003757`*^9, 
   3.836404703521566*^9}, 3.83640979285426*^9, {3.8364889102101984`*^9, 
   3.836488916274706*^9}, {3.8372619861143036`*^9, 3.837261991956586*^9}, {
   3.837262607489395*^9, 3.837262636542208*^9}, {3.839410475319894*^9, 
   3.8394105135113993`*^9}, {3.839424996878438*^9, 3.839425005728945*^9}, {
   3.8395216317067757`*^9, 3.83952165358078*^9}, {3.8395883343129025`*^9, 
   3.839588347404771*^9}, {3.83984935706341*^9, 3.839849383638239*^9}, {
   3.840893745975372*^9, 3.8408937480539846`*^9}, {3.840893786503345*^9, 
   3.8408937873859615`*^9}, {3.840894069097738*^9, 3.840894127234464*^9}, {
   3.840894204328555*^9, 3.840894271744747*^9}, {3.9554990713270836`*^9, 
   3.955499079143711*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[307]:=",ExpressionUUID->"5b4d45a1-8099-42c2-b347-70493ee82151"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"metabreassignfast", "[", 
     RowBox[{
     "l_", ",", "p_", ",", "y_", ",", "do_", ",", "b_", ",", "l2_", ",", 
      "p2_", ",", "y2_", ",", "do2_", ",", "b2_", ",", "sumdelta_", ",", 
      "div_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sumdeltatrack", ",", "div1", ",", "sumdelta22", ",", "l22", ",", 
        "y22", ",", "p22", ",", "do22", ",", "b22", ",", "l11", ",", "p11", 
        ",", "y11", ",", "do11", ",", "b11", ",", "sumdelta11"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sumdeltatrack", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"#", "+", "1"}], ",", "\[IndentingNewLine]", "0"}], 
            "]"}], "&"}], ",", "sumdelta"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"l22", "=", 
        RowBox[{"l2", "*", "sumdeltatrack"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p22", "=", 
        RowBox[{"p2", "*", "sumdeltatrack"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y22", "=", 
        RowBox[{"y2", "*", "sumdeltatrack"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"do22", "=", 
        RowBox[{"do2", "*", "sumdeltatrack"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b22", "=", 
        RowBox[{"b2", "*", "sumdeltatrack"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"div1", "=", 
        RowBox[{"RandomSample", "[", "div", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l22", "=", 
        RowBox[{"l22", "[", 
         RowBox[{"[", 
          RowBox[{"Ordering", "@", "div1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p22", "=", 
        RowBox[{"p22", "[", 
         RowBox[{"[", 
          RowBox[{"Ordering", "@", "div1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"y22", "=", 
        RowBox[{"y22", "[", 
         RowBox[{"[", 
          RowBox[{"Ordering", "@", "div1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"do22", "=", 
        RowBox[{"do22", "[", 
         RowBox[{"[", 
          RowBox[{"Ordering", "@", "div1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b22", "=", 
        RowBox[{"b22", "[", 
         RowBox[{"[", 
          RowBox[{"Ordering", "@", "div1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"sumdelta22", "=", 
        RowBox[{"sumdelta", "[", 
         RowBox[{"[", 
          RowBox[{"Ordering", "@", "div1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"l11", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             "#2", ",", "\[IndentingNewLine]", "#1"}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"l22", ",", "l"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p11", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             "#2", ",", "\[IndentingNewLine]", "#1"}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"p22", ",", "p"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"y11", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             "#2", ",", "\[IndentingNewLine]", "#1"}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"y22", ",", "y"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"do11", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             "#2", ",", "\[IndentingNewLine]", "#1"}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"do22", ",", "do"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b11", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             "#2", ",", "\[IndentingNewLine]", "#1"}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"b22", ",", "b"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sumdelta11", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             "#1", ",", "\[IndentingNewLine]", "#2"}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"sumdelta22", ",", "sumdelta"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "l11", ",", "p11", ",", "y11", ",", "do11", ",", "b11", ",", 
         "sumdelta11"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8363213993400726`*^9, 3.836321445863069*^9}, {
   3.836321477032992*^9, 3.836321727836371*^9}, {3.836321785643839*^9, 
   3.8363217856868176`*^9}, {3.837262658903365*^9, 3.837262761688884*^9}, {
   3.8375988260756173`*^9, 3.837598845612576*^9}, {3.837599046556669*^9, 
   3.837599047786749*^9}, {3.837599183000892*^9, 3.837599239265791*^9}, {
   3.837599378574221*^9, 3.837599394012285*^9}, {3.8376123356215334`*^9, 
   3.837612358843397*^9}, {3.840894283348198*^9, 3.8408942967811055`*^9}, {
   3.840894346379737*^9, 3.8408944756735353`*^9}, {3.8415725814664288`*^9, 
   3.841572602825453*^9}, 3.8831573356646986`*^9},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[308]:=",ExpressionUUID->"c722ec85-a3c7-42a6-b2a5-f66eaec8750b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"keepallmetabreassignfast", "[", 
     RowBox[{
     "l_", ",", "p_", ",", "y_", ",", "do_", ",", "b_", ",", "l2_", ",", 
      "p2_", ",", "y2_", ",", "do2_", ",", "b2_", ",", "sumdelta_", ",", 
      "gilltime_", ",", "nextgilltime_", ",", "gi_", ",", "deltal_", ",", 
      "kpp_", ",", "kyp_", ",", "kdp_", ",", "kbp_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "sumdeltatrack", ",", "div1", ",", "sumdelta22", ",", "l22", 
        ",", "y22", ",", "p22", ",", "do22", ",", "b22", ",", "gilltime22", 
        ",", "nextgilltime22", ",", "gi22", ",", "deltal22", ",", "kpp22", 
        ",", "kyp22", ",", "kdp22", ",", "kbp22", ",", "l11", ",", "p11", ",",
         "y11", ",", "do11", ",", "b11", ",", "sumdelta11", ",", "gilltime11",
         ",", "nextgilltime11", ",", "gi11", ",", "deltal11", ",", "kpp11", 
        ",", "kdp11", ",", "kyp11", ",", "kbp11"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sumdeltatrack", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"#", "+", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"-", "1"}], "]"}]}], "]"}], "&"}], ",", "sumdelta"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "l22", ",", "p22", ",", "y22", ",", "do22", ",", "b22", ",", 
          "gilltime22", ",", "nextgilltime22", ",", "gi22", ",", "deltal22", 
          ",", "kpp22", ",", "kyp22", ",", "kdp22", ",", "kbp22"}], "}"}], 
        "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "*", "sumdeltatrack"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "l2", ",", "p2", ",", "y2", ",", "do2", ",", "b2", ",", "gilltime",
             ",", "nextgilltime", ",", "gi", ",", "deltal", ",", "kpp", ",", 
            "kyp", ",", "kdp", ",", "kbp"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "l22", ",", "p22", ",", "y22", ",", "do22", ",", "b22", ",", 
          "gilltime22", ",", "nextgilltime22", ",", "gi22", ",", "deltal22", 
          ",", "kpp22", ",", "kyp22", ",", "kdp22", ",", "kbp22"}], "}"}], 
        "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", "_Complex"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "l22", ",", "p22", ",", "y22", ",", "do22", ",", "b22", ",", 
            "gilltime22", ",", "nextgilltime22", ",", "gi22", ",", "deltal22",
             ",", "kpp22", ",", "kyp22", ",", "kdp22", ",", "kbp22"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sumdeltatrack", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"sumdeltatrack", ",", "_Complex"}], "]"}], "]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "l11", ",", "p11", ",", "y11", ",", "do11", ",", "b11", ",", 
          "sumdelta11", ",", "gilltime11", ",", "nextgilltime11", ",", "gi11",
           ",", "deltal11", ",", "kpp11", ",", "kyp11", ",", "kdp11", ",", 
          "kbp11"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"l", ",", "l22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"p", ",", "p22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"y", ",", "y22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"do", ",", "do22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "b22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"sumdelta", ",", "sumdeltatrack"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"gilltime", ",", "gilltime22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"nextgilltime", ",", "nextgilltime22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"gi", ",", "gi22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"deltal", ",", "deltal22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kpp", ",", "kpp22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kyp", ",", "kyp22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kdp", ",", "kdp22"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kbp", ",", "kbp22"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "l11", ",", "p11", ",", "y11", ",", "do11", ",", "b11", ",", 
         "sumdelta11", ",", "gilltime11", ",", "nextgilltime11", ",", "gi11", 
         ",", "deltal11", ",", "kpp11", ",", "kyp11", ",", "kdp11", ",", 
         "kbp11"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8363213993400726`*^9, 3.836321445863069*^9}, {
   3.836321477032992*^9, 3.836321727836371*^9}, {3.836321785643839*^9, 
   3.8363217856868176`*^9}, {3.837262658903365*^9, 3.837262761688884*^9}, {
   3.8375988260756173`*^9, 3.837598845612576*^9}, {3.837599046556669*^9, 
   3.837599047786749*^9}, {3.837599183000892*^9, 3.837599239265791*^9}, {
   3.837599378574221*^9, 3.837599394012285*^9}, {3.8376123356215334`*^9, 
   3.837612358843397*^9}, {3.840894283348198*^9, 3.8408942967811055`*^9}, {
   3.840894346379737*^9, 3.8408944756735353`*^9}, {3.8413169152656307`*^9, 
   3.841317085747839*^9}, 3.841317131417327*^9, {3.8413174451612244`*^9, 
   3.841317568528887*^9}, {3.8413197559398046`*^9, 3.8413197633649693`*^9}, {
   3.841319875818354*^9, 3.841319882568263*^9}, {3.841319985388296*^9, 
   3.841320100044635*^9}, 3.8413233290758467`*^9, {3.841323382232057*^9, 
   3.841323421335409*^9}, {3.841323600204247*^9, 3.841323622360753*^9}, {
   3.841323741775649*^9, 3.841324479932507*^9}, {3.8413245263435216`*^9, 
   3.8413245962482853`*^9}, {3.8413265846272955`*^9, 
   3.8413265934707966`*^9}, {3.8413267259347315`*^9, 3.841326759805238*^9}, {
   3.8413272143496*^9, 3.841327235482968*^9}, {3.8413273057748194`*^9, 
   3.841327330001746*^9}, {3.84132736655657*^9, 3.841327444815552*^9}, {
   3.8413278881026545`*^9, 3.841327890262736*^9}, 3.8413292349296665`*^9, {
   3.841329370124942*^9, 3.8413293726682544`*^9}, {3.841497288178156*^9, 
   3.841497296322179*^9}, {3.841497382102222*^9, 3.8414973832101374`*^9}, {
   3.841497451606408*^9, 3.8414974578242383`*^9}, {3.841497907699073*^9, 
   3.84149791849323*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[309]:=",ExpressionUUID->"617ee5f2-fd8e-4527-86c9-557fc4e79680"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"killcells", "[", 
    RowBox[{
    "killlevel_", ",", "pc_", ",", "numcells_", ",", "deadshuff_", ",", "l_", 
     ",", "y_", ",", "p_", ",", "sumdelta_", ",", "deathwindow_", ",", 
     "deathrate_", ",", "pcz_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dead", ",", "deadpos", ",", "alive", ",", "newpos", ",", "lalive", ",",
        "palive", ",", "yalive", ",", "sumdeltaalive", ",", "l1", ",", "p1", 
       ",", "y1", ",", "sumdelta1", ",", "numdeath", ",", "deathrate1", ",", 
       "deathrateavg", ",", "pcz1", ",", "pcz22", ",", "pcz0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pcz0", "=", 
       RowBox[{"Transpose", "[", "pcz", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pcz1", "=", 
       RowBox[{"Transpose", "[", "pcz", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dead", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "<", "killlevel"}], ",", "0", ",", "#"}], "]"}], 
          "&"}], ",", "pc"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dead", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "0"}], ",", "#", ",", "1"}], "]"}], 
          "&"}], ",", "dead"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"deadpos", "=", 
       RowBox[{"Alternatives", "@@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"dead", ",", "0"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alive", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "numcells"}], "]"}], ",", "deadpos"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"newpos", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"RandomChoice", "[", "alive", "]"}], ",", 
            "\[IndentingNewLine]", "#2"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dead", ",", "deadshuff"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newpos", "=", 
       RowBox[{"RandomSample", "[", "newpos", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lalive", "=", "l"}], ";", "\[IndentingNewLine]", 
      RowBox[{"palive", "=", "p"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yalive", "=", "y"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sumdeltaalive", "=", "sumdelta"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lalive", "=", 
       RowBox[{"lalive", "[", 
        RowBox[{"[", 
         RowBox[{"Ordering", "@", "newpos"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"palive", "=", 
       RowBox[{"palive", "[", 
        RowBox[{"[", 
         RowBox[{"Ordering", "@", "newpos"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yalive", "=", 
       RowBox[{"yalive", "[", 
        RowBox[{"[", 
         RowBox[{"Ordering", "@", "newpos"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pcz1", "=", 
       RowBox[{"pcz1", "[", 
        RowBox[{"[", 
         RowBox[{"Ordering", "@", "newpos"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sumdeltaalive", "=", 
       RowBox[{"sumdeltaalive", "[", 
        RowBox[{"[", 
         RowBox[{"Ordering", "@", "newpos"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"l1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "#2",
             ",", "\[IndentingNewLine]", "#3"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dead", ",", "lalive", ",", "l"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "#2",
             ",", "\[IndentingNewLine]", "#3"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dead", ",", "palive", ",", "p"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "#2",
             ",", "\[IndentingNewLine]", "#3"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dead", ",", "yalive", ",", "y"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sumdelta1", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "#2",
             ",", "\[IndentingNewLine]", "#3"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dead", ",", "sumdeltaalive", ",", "sumdelta"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pcz22", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "==", "0"}], ",", "\[IndentingNewLine]", "#2", ",", 
            "\[IndentingNewLine]", "#3"}], "\[IndentingNewLine]", "]"}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dead", ",", "pcz1", ",", "pcz0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"numdeath", "=", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"dead", ",", "0"}], "]"}], "/", "numcells"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deathrate1", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "deathrate", "]"}], "\[LessEqual]", 
          "deathwindow"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"deathrate", ",", 
           RowBox[{"{", "numdeath", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"deathrate", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;", 
              RowBox[{"Length", "[", "deathrate", "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", "numdeath", "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deathrateavg", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "deathrate", "]"}], "<=", "deathwindow"}], 
         ",", "\[IndentingNewLine]", "0", ",", 
         RowBox[{"Mean", "[", "deathrate", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "l1", ",", "p1", ",", "y1", ",", "sumdelta1", ",", "deathrate1", ",", 
        "deathrateavg", ",", 
        RowBox[{"Transpose", "[", "pcz22", "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.836388605926401*^9, 3.836388677535135*^9}, {
   3.836388723628783*^9, 3.8363889958582253`*^9}, {3.836487925788002*^9, 
   3.836487962427821*^9}, {3.8375281823131123`*^9, 3.837528258550582*^9}, {
   3.837530528852231*^9, 3.837530570654468*^9}, 3.837599343800193*^9, {
   3.8376008757852793`*^9, 3.837600881973618*^9}, {3.837601076992379*^9, 
   3.837601140717472*^9}, {3.837611961972025*^9, 3.8376119874176464`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[310]:=",ExpressionUUID->"bd4edbc5-40a7-4cec-8281-5dab862217c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"metabproteinmemfast", "[", "simdata_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numcells", ",", " ", "lag", ",", "normpacf", ",", "normgiacf", ",", 
       "normpgicccf", ",", "i", ",", "n1", ",", "n2", ",", "output", ",", 
       "pacf", ",", "giacf", ",", "pgicccf", ",", "data", ",", "normp", ",", 
       "normgi", ",", "normpgi", ",", "bacf", ",", "normbgi", ",", "normpb", 
       ",", "bgicccf", ",", "pbcccf", ",", "normbacf", ",", "normbgicccf", 
       ",", "normpbcccf"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"simdata", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numcells", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "All"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lag", "=", 
       RowBox[{"Length", "[", " ", "data", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pacf", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AbsoluteCorrelationFunction", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"lag", "-", "1"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", ";;", "lag"}], ",", "2", ",", 
                RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
           "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"giacf", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AbsoluteCorrelationFunction", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"lag", "-", "1"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", ";;", "lag"}], ",", "3", ",", 
                RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
           "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bacf", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"AbsoluteCorrelationFunction", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"lag", "-", "1"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", ";;", "lag"}], ",", "4", ",", 
                RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
           "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"normpgi", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "lag"}], ",", "3", ",", 
              RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], "]"}],
         "*", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "lag"}], ",", "2", ",", 
              RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normbgi", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "lag"}], ",", "3", ",", 
              RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], "]"}],
         "*", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "lag"}], ",", "4", ",", 
              RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normpb", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "lag"}], ",", "2", ",", 
              RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], "]"}],
         "*", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "lag"}], ",", "4", ",", 
              RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pgicccf", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "/", "#2"}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ListCorrelate", "[", 
                  RowBox[{"#1", ",", "#2", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}], 
                 "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "lag"}], ",", "3", ",", 
                    RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "lag"}], ",", "2", ",", 
                    RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", "normpgi"}], "}"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bgicccf", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "/", "#2"}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ListCorrelate", "[", 
                  RowBox[{"#1", ",", "#2", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}], 
                 "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "lag"}], ",", "3", ",", 
                    RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "lag"}], ",", "4", ",", 
                    RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", "normbgi"}], "}"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pbcccf", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "/", "#2"}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ListCorrelate", "[", 
                  RowBox[{"#1", ",", "#2", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "0"}], "]"}], 
                 "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "lag"}], ",", "2", ",", 
                    RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "lag"}], ",", "4", ",", 
                    RowBox[{"1", ";;", "numcells"}]}], "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", "normpb"}], "}"}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"normpacf", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "/", "6"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"lag", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"pacf", "/", 
           RowBox[{"pacf", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"normgiacf", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "/", "6"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"lag", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"giacf", "/", 
           RowBox[{"giacf", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"normbacf", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "/", "6"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"lag", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"bacf", "/", 
           RowBox[{"bacf", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"normpgicccf", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "/", "6"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"lag", "-", "1"}], ")"}]}], ",", 
              RowBox[{"lag", "-", "1"}]}], "}"}]}], "]"}], ",", "pgicccf"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normbgicccf", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "/", "6"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"lag", "-", "1"}], ")"}]}], ",", 
              RowBox[{"lag", "-", "1"}]}], "}"}]}], "]"}], ",", "bgicccf"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normpbcccf", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "/", "6"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"lag", "-", "1"}], ")"}]}], ",", 
              RowBox[{"lag", "-", "1"}]}], "}"}]}], "]"}], ",", "pbcccf"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{
        "normpacf", ",", "normgiacf", ",", "normbacf", ",", "normpgicccf", 
         ",", "normbgicccf", ",", "normpbcccf"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.836487905828103*^9, 3.8364879174059305`*^9}, 
   3.837003595273329*^9, {3.8370036782457533`*^9, 3.837003885113104*^9}, {
   3.837014387746007*^9, 3.837014399639313*^9}, {3.837014434660343*^9, 
   3.837014698591934*^9}, {3.837014754623458*^9, 3.837014788385954*^9}, {
   3.8370151312329464`*^9, 3.837015186048834*^9}, {3.83701525978089*^9, 
   3.837015264358459*^9}, {3.8371692921989083`*^9, 3.83716936422424*^9}, {
   3.837169402968227*^9, 3.837169454311317*^9}, 3.8371695357244225`*^9, {
   3.837169603392225*^9, 3.8371696255507307`*^9}, {3.837169689086763*^9, 
   3.837169690857561*^9}, {3.837169732009195*^9, 3.837169750552392*^9}, {
   3.83716978359983*^9, 3.837169805648184*^9}, {3.837169862474837*^9, 
   3.837169904759946*^9}, {3.837169964110977*^9, 3.837169990444739*^9}, {
   3.8371700530168*^9, 3.837170059775613*^9}, {3.8371701163116136`*^9, 
   3.837170118189771*^9}, {3.837170167962689*^9, 3.837170284571241*^9}, {
   3.837170352457743*^9, 3.83717045693834*^9}, {3.837170582438726*^9, 
   3.837170616743701*^9}, {3.837170665626891*^9, 3.837170683448192*^9}, {
   3.8371707298647065`*^9, 3.837170757255223*^9}, {3.837170820003878*^9, 
   3.8371708807217197`*^9}, {3.837170962392919*^9, 3.837171046110065*^9}, {
   3.837171108718927*^9, 3.837171155864023*^9}, 3.83717134183611*^9, {
   3.837171383798813*^9, 3.837171452827339*^9}, {3.8371715227781754`*^9, 
   3.83717156871444*^9}, {3.837171823988685*^9, 3.837171828622686*^9}, {
   3.837171891742653*^9, 3.837172031020317*^9}, {3.8371721883783956`*^9, 
   3.837172235875765*^9}, {3.837172272391465*^9, 3.8371723880472803`*^9}, {
   3.8371724277129154`*^9, 3.8371724418090487`*^9}, {3.837172548500806*^9, 
   3.837172552436261*^9}, {3.8371728942772264`*^9, 3.83717289567745*^9}, {
   3.837173061953528*^9, 3.837173120490669*^9}, {3.83959577198864*^9, 
   3.83959578091057*^9}, {3.839605949647157*^9, 3.839605954871137*^9}, {
   3.8401081902075787`*^9, 3.8401081975953093`*^9}, {3.840975331867425*^9, 
   3.8409753670653396`*^9}, {3.840975433123391*^9, 3.8409754631579103`*^9}, {
   3.840976146196024*^9, 3.840976195799425*^9}, {3.8409762627839055`*^9, 
   3.84097647607829*^9}, {3.842714965563639*^9, 3.842714969183194*^9}, {
   3.956357385661524*^9, 3.9563573962062263`*^9}, {3.956424710795862*^9, 
   3.9564247345651207`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[311]:=",ExpressionUUID->"89770c19-730d-47f6-a928-60b24c8bc40e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"acffit", "[", "mem_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pacf", ",", "gracf", ",", "output", ",", "x"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pacf", "=", 
       RowBox[{"-", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.5", "-", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{
               RowBox[{"mem", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{
              RowBox[{"mem", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gracf", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.5", "-", 
               RowBox[{
                RowBox[{"Fit", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{
              RowBox[{
               RowBox[{"Fit", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&"}], ",", "mem"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{"pacf", ",", "gracf"}], "}"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8371719034699697`*^9, 3.837171907181344*^9}, {
   3.84062806159181*^9, 3.8406280856033335`*^9}, {3.840628149410202*^9, 
   3.8406282146370153`*^9}, {3.84062825920023*^9, 3.8406282914612274`*^9}, {
   3.8406325655133395`*^9, 3.840632580760017*^9}, {3.8406326123746057`*^9, 
   3.840632767451163*^9}, {3.840632816392916*^9, 3.840632816956014*^9}, 
   3.840632870561841*^9, 3.840632905353222*^9, {3.8406330019397535`*^9, 
   3.840633005385888*^9}, {3.840633094175601*^9, 3.840633096833692*^9}, {
   3.8409753006118*^9, 3.84097530352484*^9}, {3.841600556286066*^9, 
   3.841600580276666*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[312]:=",ExpressionUUID->"8dc2b3af-6d85-495d-af28-6671d5b2e1b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"metabacffit", "[", "mem_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pacf", ",", "gracf", ",", "bacf", ",", "output", ",", "x"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pacf", "=", 
       RowBox[{"-", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.5", "-", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{
               RowBox[{"mem", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{
              RowBox[{"mem", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gracf", "=", 
       RowBox[{"-", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.5", "-", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{
               RowBox[{"mem", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{
              RowBox[{"mem", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bacf", "=", 
       RowBox[{"-", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0.5", "-", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{
               RowBox[{"mem", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{
              RowBox[{"mem", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Exp", "[", 
                 RowBox[{"-", "x"}], "]"}]}], "}"}], ",", "x"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{"pacf", ",", "gracf", ",", "bacf"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.841154547265551*^9, 3.841154630523743*^9}, 
   3.8411549124535775`*^9, 3.8414146109667444`*^9, 3.841414758949249*^9, {
   3.841600595228081*^9, 3.841600615973207*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"c7edc0a5-e1a9-4002-81a5-2a0e1e94a47b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"titeryieldproductivity", "[", "contkill_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "titercourse", ",", "maxtiter", ",", "yield", ",", "time", ",", 
       "output", ",", "x", ",", "mxtitercourse", ",", "maxmxtiter", ",", 
       "mxyield"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"titercourse", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"contkill", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"contkill", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "13"}], "]"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mxtitercourse", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"contkill", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"contkill", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "14"}], "]"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxtiter", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"contkill", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "13"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxmxtiter", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"contkill", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "14"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yield", "=", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"Fit", "[", 
          RowBox[{
           RowBox[{"contkill", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", 
               RowBox[{
                RowBox[{"FirstPosition", "[", 
                 RowBox[{
                  RowBox[{"contkill", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "17"}], "]"}], "]"}], ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"contkill", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "17"}], "]"}], "]"}], "]"}]}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "17"}], "]"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}], "]"}], "/.", 
        RowBox[{"x", "->", "1"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mxyield", "=", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"Fit", "[", 
          RowBox[{
           RowBox[{"contkill", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", 
               RowBox[{
                RowBox[{"FirstPosition", "[", 
                 RowBox[{
                  RowBox[{"contkill", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "18"}], "]"}], "]"}], ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"contkill", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "18"}], "]"}], "]"}], "]"}]}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "18"}], "]"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}], "]"}], "/.", 
        RowBox[{"x", "->", "1"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"contkill", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{
             RowBox[{"contkill", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "17"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"contkill", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "17"}], "]"}], "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{"titercourse", ",", 
         RowBox[{"N", "[", 
          RowBox[{"maxtiter", "*", "5.478", "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "15"}]}]}], "]"}], ",", "mxtitercourse", ",", 
         RowBox[{"N", "[", 
          RowBox[{"maxmxtiter", "*", "6", "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "15"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"N", "[", "yield", "]"}], "*", "5.478", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"mxyield", "*", "5", "*", 
           RowBox[{"10", "^", 
            RowBox[{"-", "15"}]}]}], "]"}], ",", 
         RowBox[{"N", "[", "time", "]"}], ",", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"maxtiter", "*", "5.478", "*", 
            RowBox[{"10", "^", 
             RowBox[{"-", "15"}]}]}], "]"}], "/", 
          RowBox[{"N", "[", "time", "]"}]}], ",", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"maxmxtiter", "*", "5", "*", 
            RowBox[{"10", "^", 
             RowBox[{"-", "15"}]}]}], "]"}], "/", 
          RowBox[{"N", "[", "time", "]"}]}]}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.840017964130402*^9, 3.840018025637082*^9}, {
   3.840018139038282*^9, 3.8400183419275885`*^9}, {3.8400183820989513`*^9, 
   3.8400184002315383`*^9}, {3.8400184508274813`*^9, 3.840018482687186*^9}, {
   3.840018519212701*^9, 3.8400185261901927`*^9}, {3.840018966449256*^9, 
   3.840019027148946*^9}, {3.840020031714816*^9, 3.840020059701918*^9}, {
   3.840020150418646*^9, 3.840020184685188*^9}, {3.840020215627474*^9, 
   3.840020228602737*^9}, 3.840021966668925*^9, {3.840022005618333*^9, 
   3.8400220233991933`*^9}, 3.840022187971854*^9, {3.8400222346174345`*^9, 
   3.84002224765189*^9}, {3.8401193444149*^9, 3.840119352457028*^9}, {
   3.841838976636621*^9, 3.841838977121022*^9}, {3.841839188068451*^9, 
   3.841839380825864*^9}, {3.841839465576405*^9, 3.841839612167226*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->
  "In[314]:=",ExpressionUUID->"abb14e98-0354-4922-8a37-db721ca238f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fillarray", "[", "data_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxlen", ",", "output", ",", "i", ",", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxlen", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", "data"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"Length", "[", "data", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "<=", 
            RowBox[{"Length", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "!=", "0"}], 
              ",", 
              RowBox[{
               RowBox[{
                RowBox[{"output", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", 
                    RowBox[{"maxlen", "-", 
                    RowBox[{"Length", "[", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}]}], "}"}]}],
                    "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "output"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.841397952342399*^9, 3.841397957112461*^9}, {
   3.841398035584082*^9, 3.841398060842939*^9}, {3.841398251330967*^9, 
   3.841398278153096*^9}, {3.8414020938717794`*^9, 3.8414021231835356`*^9}, {
   3.841402293892874*^9, 3.841402302469069*^9}, 3.84140324374866*^9, {
   3.841403470532217*^9, 3.8414034772465487`*^9}, {3.8414035295969553`*^9, 
   3.8414035742455864`*^9}, {3.8414036110608764`*^9, 3.84140361666668*^9}, {
   3.8414036884963536`*^9, 3.841403736380154*^9}, {3.841404819989178*^9, 
   3.841405076139787*^9}, {3.841405499560785*^9, 3.8414055882261868`*^9}, {
   3.841405850946882*^9, 3.8414058562851763`*^9}, {3.841405921978765*^9, 
   3.841405927676937*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"9d8bdc68-f1a6-4d2e-882e-e488fc630cf2"]
},
WindowSize->{948, 520},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.4 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bbd1a027-588b-bd48-8ccd-abf1311e6175"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 24992, 485, 2410, "Input",ExpressionUUID->"63e0bd43-f880-41d7-ad63-12fc71369dd2"],
Cell[25553, 507, 9611, 203, 1291, "Input",ExpressionUUID->"7c0bfd69-2628-45d1-9fe7-ac41f613d277"],
Cell[35167, 712, 670, 20, 66, "Input",ExpressionUUID->"6ca669e4-40d9-472f-a784-aedd295fb7a3"],
Cell[35840, 734, 3222, 75, 332, "Input",ExpressionUUID->"8fe2ac90-5a66-45a7-a144-14e096e103cd"],
Cell[39065, 811, 2982, 70, 279, "Input",ExpressionUUID->"ec4139cf-9558-4f2e-bc2a-61d9f14f5cdc"],
Cell[42050, 883, 2428, 61, 279, "Input",ExpressionUUID->"aea8572e-8448-4453-bc24-614b0e7147b6"],
Cell[44481, 946, 10971, 248, 971, "Input",ExpressionUUID->"cb21325c-760d-4c0f-b9c9-14b868f12df5"],
Cell[55455, 1196, 10180, 230, 1451, "Input",ExpressionUUID->"5b4d45a1-8099-42c2-b347-70493ee82151"],
Cell[65638, 1428, 6622, 161, 1344, "Input",ExpressionUUID->"c722ec85-a3c7-42a6-b2a5-f66eaec8750b"],
Cell[72263, 1591, 7261, 151, 891, "Input",ExpressionUUID->"617ee5f2-fd8e-4527-86c9-557fc4e79680"],
Cell[79527, 1744, 8020, 196, 1371, "Input",ExpressionUUID->"bd4edbc5-40a7-4cec-8281-5dab862217c8"],
Cell[87550, 1942, 16527, 405, 1398, "Input",ExpressionUUID->"89770c19-730d-47f6-a928-60b24c8bc40e"],
Cell[104080, 2349, 3485, 89, 279, "Input",ExpressionUUID->"8dc2b3af-6d85-495d-af28-6671d5b2e1b1"],
Cell[107568, 2440, 3910, 105, 332, "Input",ExpressionUUID->"c7edc0a5-e1a9-4002-81a5-2a0e1e94a47b"],
Cell[111481, 2547, 6392, 159, 598, "Input",ExpressionUUID->"abb14e98-0354-4922-8a37-db721ca238f1"],
Cell[117876, 2708, 3370, 79, 359, "Input",ExpressionUUID->"9d8bdc68-f1a6-4d2e-882e-e488fc630cf2"]
}
]
*)

